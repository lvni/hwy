<!doctype html><html><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
<META NAME="MobileOptimized" CONTENT="240">
<title>产品详情</title>
    <link rel="stylesheet" href="css/public.css">
    <link rel="stylesheet" href="css/details.css?v=1">
    <link rel="stylesheet" href="javascripts/swipe/photoswipe.css"> 
    <link rel="stylesheet" href="javascripts/swipe/default-skin/default-skin.css"> 
    <script src="javascripts/swipe/photoswipe.min.js"></script> 
    <script src="javascripts/swipe/photoswipe-ui-default.min.js"></script> 
</head>

<body>
<div class="details-slide">
    <div class="top">
        <a href="javascript:history.go(-1)" ><img src="img/details_03.png" class="back"></a>
        <a href="javascript:;"  id="share"><img src="img/details_05.png" class="share"></a>
    </div>
    <div id="hl-swiper" class="hl-swiper cont">
        <div class="position-nav"></div>
        <div class="slides">
        
        </div>
    </div>
</div>
<div class="productinfo-head">
    <h3 class="title"> 加载中 ... </h3>
    <p class="price red"><i>￥</i><span class="shop_price">0.00<span></p>
    <div class="rightbox">
        <p>点赞量：<i class="red likes">0</i></p>
        <p>浏览量：<i class="red view">0</i></p>
    </div>
</div>
<div class="u-list-arrow">
    <a href="allproduct.html">
        <i>商品分类</i>
        <img src="img/arrowright.png">
    </a>
</div>
<div class="productinfo-list">
    <h4 class="details-title">商品详情</h4>
    <div class="cont">
        加载中 ...
    </div>
</div>

<div class="video" id="video" style="display:none;">
    <h4 class="details-title">视频展示</h4>
    
</div>

<div class="details-infobox">
    <h4 class="details-title">图文详情</h4>
    <div class="cont">
        加载中 ...
    </div>
</div>
<div class="comment" style="display:none;">
    <input type="text" class="cont">
    <button class="submit">
        <span>评论</span>
    </button>
</div>
<div class="comment-listbox"  style="display:none;">
    <h4 class="details-title">最新评论<i>（共3条）</i></h4>
    <div class="comment-list">
        <img src="img/hw_06.png" class="photo">
        <p class="name">东方不败</p>
        <p class="cont">看起来很好看</p>
    </div>
    <div class="comment-list">
        <img src="img/hw_06.png" class="photo">
        <p class="name">东方不败</p>
        <p class="cont">看起来很好看！</p>
    </div>
</div>
<div class="u-index-title" style="display:;">
    <p>猜你喜欢</p>
</div>
<div class="u-box-left50-right50" style="display:;" >
    <div class="rightbox" id="guess_area">

    </div>
</div>
<a href="javascript:;" class="u-backtop">
    <img src="img/index_295.png">
    回到顶部
</a>

<div class="details-bottombox">
    <div class="icon" id="kefu">
        <img src="img/details_27.png">
        <p>客服</p>
    </div>
    <div class="icon" id="detail_collect">
        <img src="img/details_22.png">
        <p>收藏</p>
    </div>
    <div class="icon" id="detail_likes_up">
        <img src="img/details_24.png">
        <p>点赞</p>
    </div>
    <button class="add" id="add" onclick="javascript:;">
        <span>加入购物车</span>
    </button>
    <button class="buy" id="buy" onclick="javascript:;" >
        <span>立即购买</span>
    </button>
</div>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <!-- <button class="pswp__button pswp__button--share" title="Share"></button> -->

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<script id="guess_item" type="text/template">
<div class="u-autoheight" onclick="javascript:location.href='details.html?id={$goods_id}'">
                <div class="dummy"></div>
                <div class="content"><img src="{$goods_thumb}" width="100%"> </div>
            </div>
</script>
<script src="javascripts/hl-swiper.js"></script>
<script src="javascripts/zepto.min.js"></script>
<script src="javascripts/main.js?v3"></script>
<script>
$(function(){
    var ignoreNavi = true;
    Bootstrap.goodsDetailLoadCallback.push(function(){
        //商品加载完注册事件
        var openPhotoSwipe = function() {
        var pswpElement = document.querySelectorAll('.pswp')[0];

        // build items array
        var items = [];
        $(".details-infobox img").each(function(i) {
             var src = $(this).attr('src');
             items.push({
                  src: src,
                  w: $(this).width(),
                  h: $(this).height(),
             });
        });
        
        // define options (if needed)
        var options = {
                 // history & focus options are disabled on CodePen        
            history: false,
            focus: false,

            showAnimationDuration: 0,
            hideAnimationDuration: 0
            
        };
        
        var gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);
        gallery.init();
    };
    
    $(".details-infobox img").click(function(){
        openPhotoSwipe();
    });
    
    });
    Bootstrap.rungoodsdetail();
    goodsCart.bindAddEvent();
    //注册客服事件
    $("#kefu").bind('click', function(){
         Util.goKefu();
    });
    //猜你喜欢
    var goodsId = Util.getQueryString('id');
    
    function getItem(goods_list) {
        var template = $("#guess_item").html();
        if (!goods_list || goods_list.length == 0) {
            return "";
        }
        var html = '<div class="rows">';
        for (i in goods_list) {
            html += Template.renderByTemplate(template, goods_list[i]);
        }
        html += "</div>";
        return html;
    }
    Util.requestApi('?r=good/guess', {goods_id:goodsId}, function(data) {
        
        if (data.data) {
            j = [];
            var html = "";
            for (i in data.data) {
            
                j.push(data.data[i]);
                if (j.length == 4) {
                    html += getItem(j);
                    j = [];
                } 

            }
            
            if (j.length > 0) {
                html += getItem(j);
            }
            
            $("#guess_area").html(html);
        }
        
        
    }, 'get', true);
    
});
</script>

</body>
</html>
