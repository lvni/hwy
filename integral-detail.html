<!doctype html><html><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
<META NAME="MobileOptimized" CONTENT="240">
<title>积分详情</title>
    <link rel="stylesheet" href="css/public.css">
    <link rel="stylesheet" href="css/integral.css">
</head>

<body>
<div class="u-top-msg" >
    <div class="title">
        <p>积分详情</p>
    </div>
    <a href="javascript:history.go(-1)" class="turnback">
        <img src="img/arrowleft.png">
    </a>
</div>

<div class="wrap">
</div>

<script id="item_template" type="text/template">
<div class="item">
    <div class="cell integral {$type}"> {$pay_points}</div>
    <div class="cell detail ">
        <div class="desc">{$change_desc}</div>
        <div class="datetime">{$change_time}</div>
    </div>
</div>
</script>
<script src="javascripts/zepto.min.js"></script>
<script src="javascripts/main.js"></script>
<script>
(function(){
     function loadLog(q) {
         Util.requestApi("?r=integral/list", q, function(data) {
                 if (data.errno != 0) {
                      messageBox.toast(data.errmsg);
                      return ;
                 }
                 var template = $("#item_template").html();
                 if (data.data.list.lenght == 0 && q.p == 1) {
                      //没有记录
                      Util.showTips($(".wrap"), "暂时没有相关记录");
                      return ;
                 } 
                 var htm = "";
                 for (i in data.data.list) {
                     var item = data.data.list[i];
                     item.type = item.pay_points > 0 ? "blue" : "red";
                     htm += Template.renderByTemplate(template, item);
                 }
                 $(".wrap").append(htm);
                 
         });
     }
     
     loadLog({p:1});
})();
</script>
</body>